{
  "fixes": [
    {
      "description": "Adds a version field so the path dependency is publishable / policy-compliant.",
      "fix_id": "cargo.path_dep_add_version",
      "operations": [
        {
          "dep": "crate-b",
          "dep_path": "../b",
          "manifest": "crates/a/Cargo.toml",
          "op": "ensure_path_dep_has_version",
          "toml_path": [
            "dependencies",
            "crate-b"
          ],
          "version": "0.2.0"
        }
      ],
      "preconditions": [
        {
          "path": "crates/a/Cargo.toml",
          "type": "file_exists"
        }
      ],
      "safety": "safe",
      "title": "Add version = \"0.2.0\" for path dependency crate-b",
      "triggers": [
        {
          "data": {
            "dep": "crate-b",
            "dep_path": "../b",
            "toml_path": [
              "dependencies",
              "crate-b"
            ]
          },
          "location": {
            "column": 1,
            "line": 7,
            "path": "crates/a/Cargo.toml"
          },
          "message": "path dependency missing version",
          "trigger": {
            "check_id": "deps.path_requires_version",
            "code": "missing_version",
            "tool": "depguard"
          }
        }
      ]
    },
    {
      "description": "Converts member dependency specs to inherit from [workspace.dependencies].",
      "fix_id": "cargo.use_workspace_dependency",
      "operations": [
        {
          "dep": "serde",
          "manifest": "crates/a/Cargo.toml",
          "op": "use_workspace_dependency",
          "preserved": {},
          "toml_path": [
            "dependencies",
            "serde"
          ]
        }
      ],
      "preconditions": [
        {
          "path": "crates/a/Cargo.toml",
          "type": "file_exists"
        }
      ],
      "safety": "safe",
      "title": "Use workspace = true for dependency serde",
      "triggers": [
        {
          "data": {
            "dep": "serde",
            "toml_path": [
              "dependencies",
              "serde"
            ]
          },
          "location": {
            "column": 1,
            "line": 8,
            "path": "crates/a/Cargo.toml"
          },
          "message": "dependency should use workspace inheritance",
          "trigger": {
            "check_id": "deps.workspace_inheritance",
            "code": "should_use_workspace",
            "tool": "depguard"
          }
        }
      ]
    },
    {
      "description": "Cargo's resolver v2 is required for correct feature unification in many modern workspaces.",
      "fix_id": "cargo.workspace_resolver_v2",
      "operations": [
        {
          "manifest": "Cargo.toml",
          "op": "ensure_workspace_resolver_v2"
        }
      ],
      "preconditions": [
        {
          "path": "Cargo.toml",
          "type": "file_exists"
        }
      ],
      "safety": "safe",
      "title": "Set [workspace].resolver = \"2\"",
      "triggers": [
        {
          "location": {
            "column": 1,
            "line": 1,
            "path": "Cargo.toml"
          },
          "message": "workspace resolver is not 2",
          "trigger": {
            "check_id": "workspace.resolver_v2",
            "code": "not_v2",
            "tool": "builddiag"
          }
        }
      ]
    }
  ],
  "inputs": {
    "artifacts_dir": "<ARTIFACTS_DIR>",
    "repo_root": "<REPO_ROOT>"
  },
  "policy": {
    "allow": [],
    "deny": [],
    "require_clean_hashes": true
  },
  "receipts": [
    {
      "parse_ok": true,
      "report_path": "<ARTIFACTS>/builddiag/report.json",
      "schema": "builddiag.report.v1",
      "sensor_id": "builddiag",
      "tool_name": "builddiag"
    },
    {
      "parse_ok": true,
      "report_path": "<ARTIFACTS>/depguard/report.json",
      "schema": "depguard.report.v1",
      "sensor_id": "depguard",
      "tool_name": "depguard"
    }
  ],
  "run": {},
  "schema": "buildfix.plan.v1",
  "summary": {
    "fixes_total": 3,
    "guarded": 0,
    "safe": 3,
    "unsafe_": 0
  },
  "tool": {
    "name": "buildfix",
    "version": "test"
  }
}